<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button (click)="close()" fill="clear" color="medium">
        <ion-icon name="close" size="large"></ion-icon>
      </ion-button>
    </ion-buttons>

    <ion-title class="modern-title">{{ bottomsheetTitle }}</ion-title>

    <ion-buttons slot="end">
      <ion-button (click)="confirmSelection()" *ngIf="multiSelect" [disabled]="selectedOptions.length === 0">
        <ion-icon name="checkmark-done" size="large"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>

  <ion-toolbar class="search-toolbar">
    <ion-searchbar debounce="300" (ionInput)="filterOptions($event)" placeholder="Search options..."
      color="light" mode="ios"></ion-searchbar>
  </ion-toolbar>
</ion-header>

<ion-content>
  <ion-list lines="none" class="selection-list">
    <ion-item button *ngFor="let option of loadedOptions; trackBy: trackByRef" (click)="selectOption(option)"
      [class.is-selected]="isSelected(option)" [class.is-site-selected]="isSiteSelected(option)" detail="false">
      
      <ion-label>
        {{ option?.p?.Name || option?.p?.PlotNo || option?.p?.MaterialName || option?.p?.VendorName || 'Unnamed Option' }}
      </ion-label>

      <ion-checkbox *ngIf="multiSelect" slot="end" [checked]="isSelected(option)" [disabled]="isDisabled(option)"
        aria-label="Select option"></ion-checkbox>
        
      <ion-icon *ngIf="!multiSelect && isSelected(option)" slot="end" name="checkmark-circle-outline" color="primary"></ion-icon>

    </ion-item>
  </ion-list>

  <div *ngIf="loadedOptions.length === 0" class="no-data-message">
    <ion-text color="medium">
      <p>No options match your search or are currently available.</p>
    </ion-text>
  </div>

  <ion-infinite-scroll (ionInfinite)="loadMore($event)">
    <ion-infinite-scroll-content loadingSpinner="crescent" loadingText="Loading more..."></ion-infinite-scroll-content>
  </ion-infinite-scroll>
</ion-content>